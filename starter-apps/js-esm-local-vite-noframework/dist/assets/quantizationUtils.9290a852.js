import{b8 as n,b9 as t,aG as e,ba as s,bb as r,bc as i,bd as o,be as a,ao as u,as as l,ar as c,ap as m,aq as h}from"./vendor.d9ce5f39.js";import{t as f}from"./json.df9e51f4.js";const p=[0,0];function x(n,t){if(!t)return null;if("x"in t){const e={x:0,y:0};return[e.x,e.y]=n(t.x,t.y,p),null!=t.z&&(e.z=t.z),null!=t.m&&(e.m=t.m),e}if("xmin"in t){const e={xmin:0,ymin:0,xmax:0,ymax:0};return[e.xmin,e.ymin]=n(t.xmin,t.ymin,p),[e.xmax,e.ymax]=n(t.xmax,t.ymax,p),t.hasZ&&(e.zmin=t.zmin,e.zmax=t.zmax,e.hasZ=!0),t.hasM&&(e.mmin=t.mmin,e.mmax=t.mmax,e.hasM=!0),e}return"rings"in t?{rings:g(t.rings,n),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:g(t.paths,n),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:y(t.points,n),hasM:t.hasM,hasZ:t.hasZ}:void 0}function g(n,t){const e=[];for(const s of n)e.push(y(s,t));return e}function y(n,t){const e=[];for(const s of n){const n=t(s[0],s[1],[0,0]);e.push(n),s.length>2&&n.push(s[2]),s.length>3&&n.push(s[3])}return e}async function b(n,t){if(!t)return;const e=Array.isArray(n)?n.map((n=>{var t;return null==(t=n.geometry)?void 0:t.spatialReference})):[n];await a(e.map((n=>({source:n,dest:t}))))}const z=x.bind(null,n),_=x.bind(null,t);function d(n,t,a){return n?(a||(a=t,t=n.spatialReference),e(t)&&e(a)&&!s(t,a)?r(t,a)?i(a)?z(n):_(n):o(f,[n],t,a,null)[0]:n):n}const M=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(n,t,e){if(!n||!n.length||!t||!e||s(t,e))return n;const r={geometries:n,inSpatialReference:t,outSpatialReference:e,resolve:null};return this._jobs.push(r),new Promise((n=>{r.resolve=n,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const n=this._jobs.shift();if(!n)return;const{geometries:t,inSpatialReference:e,outSpatialReference:s,resolve:a}=n;r(e,s)?i(s)?a(t.map(z)):a(t.map(_)):a(o(f,t,e,s,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function v(n,t,e){return M.push(n,t,e)}const Z=(n,t,e)=>[t,e],j=(n,t,e)=>[t,e,n[2]],w=(n,t,e)=>[t,e,n[2],n[3]];function R(n){return n?{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}:null}function P({scale:n,translate:t},e){return Math.round((e-t[0])/n[0])}function A({scale:n,translate:t},e){return Math.round((t[1]-e)/n[1])}function S(n,t,e){const s=[];let r,i,o,a;for(let u=0;u<e.length;u++){const l=e[u];u>0?(o=P(n,l[0]),a=A(n,l[1]),o===r&&a===i||(s.push(t(l,o-r,a-i)),r=o,i=a)):(r=P(n,l[0]),i=A(n,l[1]),s.push(t(l,r,i)))}return s.length>0?s:null}function L({scale:n,translate:t},e){return e*n[0]+t[0]}function T({scale:n,translate:t},e){return t[1]-e*n[1]}function q(n,t,e){const s=new Array(e.length);if(!e.length)return s;const[r,i]=n.scale;let o=L(n,e[0][0]),a=T(n,e[0][1]);s[0]=t(e[0],o,a);for(let u=1;u<e.length;u++){const n=e[u];o+=n[0]*r,a-=n[1]*i,s[u]=t(n,o,a)}return s}function G(n,t,e){const s=new Array(e.length);for(let r=0;r<e.length;r++)s[r]=q(n,t,e[r]);return s}function k(n,t,e,s,r){return t.points=function(n,t,e,s){return S(n,e?s?w:j:s?j:Z,t)}(n,e.points,s,r),t}function B(n,t,e,s,r){return t.x=P(n,e.x),t.y=A(n,e.y),t!==e&&(s&&(t.z=e.z),r&&(t.m=e.m)),t}function C(n,t,e,s,r){const i=function(n,t,e,s){const r=[],i=e?s?w:j:s?j:Z;for(let o=0;o<t.length;o++){const e=S(n,i,t[o]);e&&e.length>=3&&r.push(e)}return r.length?r:null}(n,e.rings,s,r);return i?(t.rings=i,t):null}function D(n,t,e,s,r){const i=function(n,t,e,s){const r=[],i=e?s?w:j:s?j:Z;for(let o=0;o<t.length;o++){const e=S(n,i,t[o]);e&&e.length>=2&&r.push(e)}return r.length?r:null}(n,e.paths,s,r);return i?(t.paths=i,t):null}function E(n,t){return n&&t?u(t)?B(n,{},t,!1,!1):l(t)?D(n,{},t,!1,!1):c(t)?C(n,{},t,!1,!1):m(t)?k(n,{},t,!1,!1):h(t)?(i=!1,o=!1,(s={}).xmin=P(e=n,(r=t).xmin),s.ymin=A(e,r.ymin),s.xmax=P(e,r.xmax),s.ymax=A(e,r.ymax),s!==r&&(i&&(s.zmin=r.zmin,s.zmax=r.zmax),o&&(s.mmin=r.mmin,s.mmax=r.mmax)),s):null:null;var e,s,r,i,o}function F(n,t,e,s,r){return t.points=function(n,t,e,s){return q(n,e?s?w:j:s?j:Z,t)}(n,e.points,s,r),t}function H(n,t,e,s,r){return t.x=L(n,e.x),t.y=T(n,e.y),t!==e&&(s&&(t.z=e.z),r&&(t.m=e.m)),t}function I(n,t,e,s,r){return t.rings=function(n,t,e,s){return G(n,e?s?w:j:s?j:Z,t)}(n,e.rings,s,r),t}function J(n,t,e,s,r){return t.paths=function(n,t,e,s){return G(n,e?s?w:j:s?j:Z,t)}(n,e.paths,s,r),t}export{B as L,F as U,E as d,v as j,H as k,R as m,b as p,I as q,J as v,d as y};
